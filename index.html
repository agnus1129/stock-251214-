<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶ˆì‚¬ì‚¬ê¸° ì£¼ì‹ ë¦¬ë”©ë¶ (ìµœì¢… ì™„ì„±)</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* --- CSS ê¸°ë³¸ ìŠ¤íƒ€ì¼ --- */
        body { font-family: 'Malgun Gothic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f7f7f7; padding: 20px; }
        .app-container { max-width: 450px; margin: 0 auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15); }
        h1 { text-align: center; color: #4b4b4b; font-size: 1.8em; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding-bottom: 10px; border-bottom: 2px solid #ddd; }
        .section-header { border-left: 5px solid #8B4513; padding-left: 10px; margin-top: 25px; margin-bottom: 15px; }
        
        /* ì˜ì—­ë³„ ë°°ê²½ìƒ‰ êµ¬ë¶„ */
        .section-area { padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        .area-1 { background-color: #fcfcfc; border: 1px solid #e9e9e9; } 
        .area-2 { background-color: #fff; border: 1px solid #d0d0d0; } 
        .area-3 { background-color: #fcfcfc; border: 1px solid #e9e9e9; } 
        .sub-sector { background-color: #f0f0f0; padding: 10px 15px; border-radius: 5px; margin-top: 10px; margin-bottom: 10px; }
        .sub-sector-alt { background-color: #f5f5f5; padding: 10px 15px; border-radius: 5px; margin-top: 10px; margin-bottom: 10px; }
        .pivot { color: #8B4513; font-weight: normal; background-color: #fcf4e8; padding: 5px 8px; border-radius: 4px; display: inline-block; font-size: 0.9em; }
        .pivot-desc { font-size: 0.8em; color: #5a5a5a; margin-top: 5px; line-height: 1.4; }

        /* ìˆ˜ìµ/ì†ì‹¤ ìƒ‰ìƒ */
        .profit { color: #00a86b; font-weight: bold; } 
        .loss { color: #dc3545; font-weight: bold; }   
        .neutral { color: #6c757d; font-weight: bold; }
        
        /* --- ì…ë ¥ UI ê°œì„  ìŠ¤íƒ€ì¼: ì›/ì£¼ ë‹¨ìœ„ ì•ˆìª½ ì •ë ¬ --- */
        .input-group { display: flex; align-items: center; margin-bottom: 15px; }
        .input-group label { margin-right: 10px; width: 120px; flex-shrink: 0; }
        .input-unit-wrapper { display: flex; flex-grow: 1; position: relative; align-items: center; } /* align-items: center ì¶”ê°€ */
        .input-unit-wrapper input { padding-right: 35px; width: 100%; }
        /* input-unitì˜ ìœ„ì¹˜ë¥¼ ë¯¸ì„¸ ì¡°ì •í•˜ì—¬ ì¤‘ì•™ ì •ë ¬ ë³´ì • */
        .input-unit { 
            position: absolute; 
            right: 10px; 
            font-weight: bold; 
            color: #4b4b4b; 
            white-space: nowrap;
            /* Yì¶• ë¯¸ì„¸ ì¡°ì • (1px ì•„ë˜ë¡œ ì´ë™í•˜ì—¬ ì…ë ¥ í•„ë“œ ì¤‘ì•™ì— ë§ì¶¤) */
            transform: translateY(1px); 
        }

        /* ì½ê¸° ì „ìš© ìŠ¤íƒ€ì¼ */
        input[readonly], textarea[readonly], select[readonly] { background-color: #e9ecef; cursor: not-allowed; color: #6c757d; }
        
        /* íˆ¬ì ì •ë³´ í…ìŠ¤íŠ¸ ê°•ì¡° */
        .status-ë³´ìœ  { color: #00a86b; }
        .status-ì²­ì‚° { color: #dc3545; }
        .status-ë§¤ìˆ˜ { color: #007bff; } 

        input[type="number"], input[type="text"], input[type="date"], select, textarea { padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        
        /* --- ë©”ì¸ ë²„íŠ¼ ì‹œì¸ì„± ê°•í™” --- */
        button { padding: 12px 15px; background-color: #8B4513; color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s; font-size: 1.1em; font-weight: bold; }
        button.main-entry { background-color: #ff5722; font-size: 1.3em; padding: 15px; } 
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        button.secondary { background-color: #6c757d; }
        
        /* --- ë°˜ì§ì„ ì• ë‹ˆë©”ì´ì…˜ ì •ì˜ --- */
        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(255, 87, 34, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 87, 34, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 87, 34, 0); }
        }
        .pulse { animation: pulse-border 1s infinite; }

        button.save-purchase { background-color: #00a86b; } 

        /* ë§¤ìˆ˜/ì²­ì‚° ë¦¬ìŠ¤íŠ¸ êµ¬ë¶„ */
        .records-section-header { background-color: #f0f0f0; padding: 10px; margin-top: 20px; border-radius: 5px; font-weight: bold; border-left: 5px solid #007bff; }
        .records-list-container { margin-bottom: 30px; }
        .records-list-item { 
            padding: 15px; 
            border: 1px solid #ddd; 
            margin-top: -1px; 
            cursor: pointer; 
            transition: background-color 0.2s;
        }
        .records-list-item:hover {
            background-color: #f5f5f5;
        }

        .developer-credit { margin-top: 40px; padding-top: 20px; border-top: 1px solid #eee; text-align: center; color: #6c757d; font-size: 0.9em; }
        .version-info { font-size: 0.75em; color: #aaa; margin-top: 5px; }
        
        /* ë©”ì¸í™”ë©´ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .entry-box {
            margin: 0 auto; 
            border: 1px solid #ddd; 
            padding: 20px; 
            border-radius: 8px; 
            background-color: #f7f9fc; 
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // ------------------- 0. ë°ì´í„° ë° ìƒìˆ˜ ì •ì˜ -------------------
        
        const ALL_STOCKS = [
            { code: "000720", name: "í˜„ëŒ€ê±´ì„¤" }, { code: "096770", name: "SKì´ë…¸ë² ì´ì…˜" }, { code: "078930", name: "GSìš°" },
            { code: "003555", name: "LGìš°" }, { code: "028300", name: "HLB" }, { code: "042660", name: "í•œí™”ì˜¤ì…˜" },
            { code: "003550", name: "LG" }, { code: "005490", name: "POSCOí™€ë”©ìŠ¤" }, { code: "051900", name: "LGìƒí™œê±´ê°•" },
            { code: "000400", name: "HDí˜„ëŒ€" }, { code: "010950", name: "S-Oil" }, { code: "036570", name: "OCIí™€ë”©ìŠ¤" },
            { code: "298700", name: "HSíš¨ì„±ì²¨ë‹¨ì†Œì¬" }, { code: "004170", name: "ì‹ ì„¸ê³„" }, { code: "031440", name: "ì‹ ì„¸ê³„í‘¸ë“œ" },
            { code: "001300", name: "ê²½ë°©" }, { code: "123450", name: "ì—ìŠ¤í‹°ì•„ì´" }, { code: "032600", name: "SKë””ìŠ¤ì»¤ë²„ë¦¬" },
            { code: "348610", name: "ì˜¤ë¦„í…Œë¼í“¨í‹±" }, { code: "002780", name: "ì˜ì›ë¬´ì—­" }, { code: "185490", name: "ì•±í´ë¡ " },
            { code: "009180", name: "BYC" }, { code: "002580", name: "ì´í™”ì‚°ì—…" }, { code: "000660", name: "SKí•˜ì´ë‹‰ìŠ¤" },
            { code: "005930", name: "ì‚¼ì„±ì „ì" }, { code: "015760", name: "í•œêµ­ì „ë ¥" }, { code: "035720", name: "ì¹´ì¹´ì˜¤" },
            { code: "079160", name: "CJ CGV" }, { code: "096610", name: "ê³ ì˜" }, { code: "293490", name: "ì¹´ì¹´ì˜¤ê²Œì„ì¦ˆ" },
            { code: "323410", name: "ì¹´ì¹´ì˜¤ë±…í¬" }, { code: "247540", name: "í¬ìŠ¤ì½”í“¨ì²˜ì— " }, { code: "000830", name: "ì‚¼ì„±ì¤‘ê³µì—…" },
            { code: "035420", name: "NAVER" }, { code: "000270", name: "ê¸°ì•„" }, { code: "005380", name: "í˜„ëŒ€ì°¨" },
            { code: "051910", name: "LGí™”í•™" }, { code: "006400", name: "ì‚¼ì„±SDI" }, { code: "011070", name: "LGì´ë…¸í…" },
            { code: "034220", name: "LGë””ìŠ¤í”Œë ˆì´" }, { code: "326030", name: "SKë°”ì´ì˜¤ì‚¬ì´ì–¸ìŠ¤" }, { code: "000000", name: "LGì”¨ì—”ì—ìŠ¤" },
            { code: "000810", name: "ì‚¼ì„±ë¬¼ì‚°" }, { code: "201080", name: "ë‘ì‚°ì—ë„ˆë¹Œë¦¬í‹°" }, 
        ];

        const getStockData = (symbol) => {
             return {
                symbol: symbol,
                ì¢…ëª©ëª…: ALL_STOCKS.find(s => s.code === symbol)?.name || "ì„ íƒëœ ì¢…ëª©",
                ì–´ì œ_ì¢…ê°€: 75000,
                ì˜¤ëŠ˜_ì¢…ê°€: 78000,
                ë¶„ì„_ìë£Œ_B1: "ê°€ê²© íë¦„ì€ ê¸ì •ì ì´ë‚˜, ë‹¨ê¸° ì¡°ì • ê°€ëŠ¥ì„±ì´ ë†’ìŒ. (KOA ë¶„ì„ ìë£Œ)",
                TODAY_HIGH_PRICE: 78500,
                pivot_price: 76550,
                high_52w: 85000,
                low_52w: 60000,
            };
        };

        const INITIAL_USER_INPUT = {
            ë‚˜ì˜_ì§„ì…ê°€: 0, ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰: 0, status: "ê³„ì† ë³´ìœ ",
            ë§¤ìˆ˜ê°€: 0, ì†ì ˆê°€: 0, ëª©í‘œê°€_1ì°¨: 0, ëª©í‘œê°€_2ì°¨: 0,
            liquidationPriceType: "ì¥ì¤‘ ê³ ê°€", liquidationValue: 0, liquidationQuantityPercent: 0,
            outlook: "", 
        };
        
        const IS_AUTHOR = true; 

        const DAILY_RECORDS = {
            "005930_2025-12-10": {
                ...INITIAL_USER_INPUT, ë‚˜ì˜_ì§„ì…ê°€: 75000, ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰: 5, status: "ë§¤ìˆ˜",
                ë§¤ìˆ˜ê°€: 75500, ì†ì ˆê°€: 70000, ëª©í‘œê°€_1ì°¨: 82000, ëª©í‘œê°€_2ì°¨: 90000, outlook: "ë‹¨ê¸° ë§¤ìˆ˜ ì¶”ì²œ",
            },
            "000660_2025-12-12": {
                ...INITIAL_USER_INPUT, ë‚˜ì˜_ì§„ì…ê°€: 110000, ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰: 10, status: "ì²­ì‚°",
                liquidationValue: 120000, liquidationQuantityPercent: 100, outlook: "ëª©í‘œê°€ ë„ë‹¬. ì²­ì‚° ê¶Œìœ .",
            },
            "035720_2025-12-10": { 
                ...INITIAL_USER_INPUT, ë‚˜ì˜_ì§„ì…ê°€: 60000, ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰: 10, status: "ë§¤ìˆ˜",
                ë§¤ìˆ˜ê°€: 60000, ì†ì ˆê°€: 55000, ëª©í‘œê°€_1ì°¨: 70000, ëª©í‘œê°€_2ì°¨: 80000, outlook: "ì‹ ê·œ ì‚¬ì—… ê¸°ëŒ€ê°ìœ¼ë¡œ ë§¤ìˆ˜ ì¶”ì²œ",
            },
        };
        
        const purchaseRecommendations = [
             { id: 1, type: 'ë§¤ìˆ˜', symbol: '005930', date: '2025-12-10', name: 'ì‚¼ì„±ì „ì'},
             { id: 3, type: 'ë§¤ìˆ˜', symbol: '035720', date: '2025-12-10', name: 'ì¹´ì¹´ì˜¤'},
        ];
        
        const liquidationRecommendations = [
             { id: 2, type: 'ì²­ì‚°', symbol: '000660', date: '2025-12-12', name: 'SKí•˜ì´ë‹‰ìŠ¤'},
        ];


        // ------------------- B.2 í•µì‹¬ ê³„ì‚° ë¡œì§ -------------------
        const calculateMetrics = (ì§„ì…ê°€, ë³´ìœ ìˆ˜ëŸ‰, ì˜¤ëŠ˜ì¢…ê°€) => {
            const actualProfit = ë³´ìœ ìˆ˜ëŸ‰ * (ì˜¤ëŠ˜ì¢…ê°€ - ì§„ì…ê°€); 
            const profitDifference = ì˜¤ëŠ˜ì¢…ê°€ - ì§„ì…ê°€;
            const yieldRatio = (profitDifference / ì§„ì…ê°€) * 100;
            const profitClass = actualProfit > 0 ? 'profit' : actualProfit < 0 ? 'loss' : 'neutral';
            
            let yieldDisplay;
            if (actualProfit === 0) { yieldDisplay = "0.00"; } 
            else if (actualProfit < 0) { yieldDisplay = `${yieldRatio.toFixed(2)}`; } 
            else { yieldDisplay = `+${yieldRatio.toFixed(2)}`; }
            
            return { actualProfit, yieldDisplay, profitClass };
        };

        // ------------------- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜: ë‚ ì§œì—ì„œ ìš”ì¼ ê³„ì‚° -------------------
        const getDayOfWeek = (dateString) => {
            if (!dateString) return "";
            const days = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
            const date = new Date(dateString);
            if (isNaN(date.getTime())) return ""; 
            return `(${days[date.getDay()]})`;
        };


        // ------------------- ë§¤ìˆ˜ ì •ë³´ í‘œì‹œ/ì…ë ¥ ì»´í¬ë„ŒíŠ¸ -------------------
        const PurchaseInput = ({ data, handleChange, isReadOnly }) => (
            <div style={{ border: '1px dashed #007bff', padding: '15px', marginTop: '15px', borderRadius: '5px', backgroundColor: 'white' }}>
                <h4>ğŸ›’ ë§¤ë§¤ ì „ëµ</h4>
                
                <div className="input-group">
                    <label>ë§¤ìˆ˜ê°€:</label>
                    <div className="input-unit-wrapper">
                        <input type="number" value={data.ë§¤ìˆ˜ê°€} onChange={(e) => handleChange('ë§¤ìˆ˜ê°€', e.target.value)} readOnly={isReadOnly} />
                        <span className="input-unit">ì›</span>
                    </div>
                </div>
                <div className="input-group">
                    <label>ì†ì ˆê°€:</label>
                    <div className="input-unit-wrapper">
                        <input type="number" value={data.ì†ì ˆê°€} onChange={(e) => handleChange('ì†ì ˆê°€', e.target.value)} readOnly={isReadOnly} />
                        <span className="input-unit">ì›</span>
                    </div>
                </div>
                <div className="input-group">
                    <label>1ì°¨ ëª©í‘œê°€:</label>
                    <div className="input-unit-wrapper">
                        <input type="number" value={data.ëª©í‘œê°€_1ì°¨} onChange={(e) => handleChange('ëª©í‘œê°€_1ì°¨', e.target.value)} readOnly={isReadOnly} />
                        <span className="input-unit">ì›</span>
                    </div>
                </div>
                <div className="input-group">
                    <label>2ì°¨ ëª©í‘œê°€:</label>
                    <div className="input-unit-wrapper">
                        <input type="number" value={data.ëª©í‘œê°€_2ì°¨} onChange={(e) => handleChange('ëª©í‘œê°€_2ì°¨', e.target.value)} readOnly={isReadOnly} />
                        <span className="input-unit">ì›</span>
                    </div>
                </div>
                
                {!isReadOnly && (
                    <button onClick={() => alert('ë§¤ìˆ˜ ì „ëµì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.')} className="save-purchase" style={{ width: '100%', marginTop: '10px' }}>
                        ë§¤ìˆ˜ ì „ëµ ì €ì¥
                    </button>
                )}
            </div>
        );


        // ------------------- ëª¨ë‹¬/ê¸°ë¡ í™ˆ ì»´í¬ë„ŒíŠ¸ (RecordsHome ìˆ˜ì •) -------------------
        const StockModal = ({ isOpen, onClose, onSelectStock }) => {
            if (!isOpen) return null;
            return (
                <div className="modal-overlay">
                    <div className="modal-content">
                        <div className="modal-header">
                            <h3>ğŸ” ì¢…ëª© ì§ì ‘ ì„ íƒí•˜ê¸°</h3>
                            <button onClick={onClose} className="secondary">ë‹«ê¸°</button>
                        </div>
                        <div>
                            {ALL_STOCKS.map(stock => (
                                <div key={stock.code} className="modal-list-item" onClick={() => { onSelectStock(stock); onClose(); }} style={{ padding: '8px 10px', borderBottom: '1px solid #eee', cursor: 'pointer' }}>
                                    <strong>{stock.name}</strong> ({stock.code})
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };
        
        const RecordsHome = ({ onSelectRecord }) => (
            <div style={{ marginTop: '20px' }}>
                <div className="records-list-container">
                    <div className="records-section-header" style={{ borderLeftColor: '#007bff' }}>ğŸ›’ ë§¤ìˆ˜ ì¶”ì²œ ì¢…ëª©</div>
                    {purchaseRecommendations.length === 0 ? (
                        <p style={{ padding: '15px', border: '1px solid #eee', borderTop: 'none' }}>í˜„ì¬ ì¶”ì²œ ë§¤ìˆ˜ ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    ) : (
                        purchaseRecommendations.map(record => (
                            <div 
                                key={record.id}
                                onClick={() => onSelectRecord(record)}
                                className="records-list-item"
                                style={{ backgroundColor: '#e0f2ff' }}
                            >
                                <strong className="status-ë§¤ìˆ˜">{record.name}</strong> ({record.symbol})
                            </div>
                        ))
                    )}
                </div>

                <div className="records-list-container">
                    <div className="records-section-header" style={{ borderLeftColor: '#dc3545' }}>ğŸ”´ ì²­ì‚° ê¶Œìœ  ì¢…ëª©</div>
                    {liquidationRecommendations.length === 0 ? (
                        <p style={{ padding: '15px', border: '1px solid #eee', borderTop: 'none' }}>í˜„ì¬ ê¶Œìœ  ì²­ì‚° ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    ) : (
                        liquidationRecommendations.map(record => (
                            <div 
                                key={record.id}
                                onClick={() => onSelectRecord(record)}
                                className="records-list-item"
                                style={{ backgroundColor: '#ffe0e0' }}
                            >
                                <strong className="status-ì²­ì‚°">{record.name}</strong> ({record.symbol})
                            </div>
                        ))
                    )}
                </div>
                
                <p style={{ textAlign: 'center', color: '#6c757d', marginTop: '10px' }}>* ì¢…ëª©ì„ í´ë¦­í•˜ë©´ ìƒì„¸ ë§¤ë§¤ ì „ëµì´ í‘œì‹œë©ë‹ˆë‹¤.</p>
            </div>
        );


        // ------------------- ë³´ê³ ì„œ ë³¸ë¬¸ ì»´í¬ë„ŒíŠ¸ -------------------
        const ReportContent = ({ entryData, stockData, onGoHome }) => {
            const [data, setData] = useState(entryData);
            
            const { actualProfit, yieldDisplay, profitClass } = useMemo(() => 
                calculateMetrics(data.ë‚˜ì˜_ì§„ì…ê°€, data.ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰, stockData.ì˜¤ëŠ˜_ì¢…ê°€), 
                [data.ë‚˜ì˜_ì§„ì…ê°€, data.ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰, stockData.ì˜¤ëŠ˜_ì¢…ê°€]
            );

            const handleChange = (field, value) => {
                const isNumeric = ['ë‚˜ì˜_ì§„ì…ê°€', 'ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰', 'liquidationValue', 'liquidationQuantityPercent', 'ë§¤ìˆ˜ê°€', 'ì†ì ˆê°€', 'ëª©í‘œê°€_1ì°¨', 'ëª©í‘œê°€_2ì°¨'].includes(field);
                
                const isPublicField = field === 'ë‚˜ì˜_ì§„ì…ê°€' || field === 'ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰';

                if (isPublicField || IS_AUTHOR) {
                    setData(prev => ({ ...prev, [field]: isNumeric ? Number(value) : value }));
                } else {
                    alert("ì´ ì •ë³´ëŠ” ì£¼ì¸ë‹˜ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
            };

            const handleStatusChange = (newStatus) => {
                if (IS_AUTHOR) {
                    setData(prev => ({ 
                        ...prev, 
                        status: newStatus,
                        liquidationValue: newStatus === "ì²­ì‚°" ? stockData.TODAY_HIGH_PRICE : prev.liquidationValue
                    }));
                } else {
                     alert("ì´ ì •ë³´ëŠ” ì£¼ì¸ë‹˜ë§Œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
            };

            const handlePriceTypeChange = (type) => {
                 if (IS_AUTHOR) {
                    setData(prev => ({
                        ...prev,
                        liquidationPriceType: type,
                        liquidationValue: type === "ì¥ì¤‘ ê³ ê°€" ? stockData.TODAY_HIGH_PRICE : 0
                    }));
                }
            };
            
            const handleSubmitLiquidation = () => {
                if (data.status !== "ì²­ì‚°") return;
                alert(`âœ… ì²­ì‚° ê¸°ë¡ì„ ì„œë²„ì— ì „ì†¡í•˜ê³ , ì´ì „ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.`);
                onGoHome();
            };

            const statusClass = (status) => 
                status === "ê³„ì† ë³´ìœ " ? 'status-ë³´ìœ ' : 
                status === "ì²­ì‚°" ? 'status-ì²­ì‚°' : 'status-ë§¤ìˆ˜';


            return (
                <div>
                    <button onClick={onGoHome} className="secondary" style={{ marginBottom: '15px' }}>
                        â† ì´ì „ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
                    </button>

                    {/* 1. ê¸°ë³¸ ì •ë³´ (B.1) */}
                    <div className="section-area area-1">
                        <div className="section-header"><h2>1. ê¸°ë³¸ ì •ë³´</h2></div>
                        
                        <div className="sub-sector">
                            <p>ğŸ“ˆ **ì–´ì œ ì¢…ê°€:** {stockData.ì–´ì œ_ì¢…ê°€.toLocaleString()}ì›</p>
                            <p>ğŸ“Š **ì˜¤ëŠ˜ ì¢…ê°€:** {stockData.ì˜¤ëŠ˜_ì¢…ê°€.toLocaleString()}ì›</p>
                        </div>

                        <div className="sub-sector-alt">
                            <p>ğŸ”½ **52ì£¼ ì‹ ì €ê°€:** {stockData.low_52w.toLocaleString()}ì›</p>
                            <p>ğŸ”¼ **52ì£¼ ì‹ ê³ ê°€:** {stockData.high_52w.toLocaleString()}ì›</p>
                            
                            <div style={{ marginTop: '15px' }}>
                                {/* ê¸ˆì•¡ë§Œ êµµê²Œ í‘œì‹œ */}
                                <p><strong className="pivot">ê¸ˆì£¼ì˜ Pivot ê¸°ì¤€ê°€ê²©: <span style={{ fontWeight: '900' }}>{stockData.pivot_price.toLocaleString()}ì›</span></strong></p>
                                <p className="pivot-desc">Pivot ê¸°ì¤€ê°€ê²©ì€ ì´ë³´ë‹¤ ì£¼ê°€ê°€ ë†’ìœ¼ë©´ ì§€ì§€ì„ ì´ ë˜ê³  ë‚®ìœ¼ë©´ ì €í•­ì„ ì´ ë©ë‹ˆë‹¤.</p>
                            </div>
                        </div>
                    </div>

                    {/* 2. ë‚˜ì˜ íˆ¬ì ì‹¤ì  (B.2) */}
                    <div className="section-area area-2">
                        <div className="section-header"><h2>2. ë‚˜ì˜ íˆ¬ì ì‹¤ì </h2></div>
                        
                        <div className="input-group">
                            <label>ë‚˜ì˜ ì§„ì…ê°€:</label>
                            <div className="input-unit-wrapper">
                                <input type="number" value={data.ë‚˜ì˜_ì§„ì…ê°€} onChange={(e) => handleChange('ë‚˜ì˜_ì§„ì…ê°€', e.target.value)} inputMode="numeric" />
                                <span className="input-unit">ì›</span>
                            </div>
                        </div>
                        <div className="input-group">
                            <label>ë‚˜ì˜ ë³´ìœ  ìˆ˜ëŸ‰:</label>
                            <div className="input-unit-wrapper">
                                <input type="number" value={data.ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰} onChange={(e) => handleChange('ë‚˜ì˜_ë³´ìœ _ìˆ˜ëŸ‰', e.target.value)} inputMode="numeric"/>
                                <span className="input-unit">ì£¼</span>
                            </div>
                        </div>
                        
                        <h4 style={{ marginTop: '20px' }}>ğŸ“Š ê³„ì‚° ê²°ê³¼</h4>
                        <p>ì˜¤ëŠ˜ ì¢…ê°€ ëŒ€ë¹„ ìˆ˜ìµë¥ : <span className={profitClass}>{yieldDisplay}%</span></p>
                        <p>ì‹¤ì œ ìˆ˜ìµê¸ˆì•¡: <span className={profitClass}>{actualProfit.toLocaleString()}ì›</span></p>
                    </div>

                    {/* 3. íˆ¬ì ì •ë³´ (B.3) */}
                    <div className="section-area area-3">
                        <div className="section-header"><h2>3. íˆ¬ì ì •ë³´</h2></div>
                        
                        <label>ë³´ìœ /ì²­ì‚° ì„ íƒ:
                            <select 
                                value={data.status} 
                                onChange={(e) => handleStatusChange(e.target.value)}
                                readOnly={!IS_AUTHOR}
                            >
                                <option value="ë§¤ìˆ˜" className="status-ë§¤ìˆ˜ status-option">ë§¤ìˆ˜</option>
                                <option value="ê³„ì† ë³´ìœ " className="status-ë³´ìœ  status-option">ê³„ì† ë³´ìœ </option>
                                <option value="ì²­ì‚°" className="status-ì²­ì‚° status-option">ì²­ì‚°</option>
                            </select>
                        </label>
                        
                        {/* ë§¤ìˆ˜ í•­ëª© í™œì„±í™” */}
                        {data.status === "ë§¤ìˆ˜" && (
                            <PurchaseInput data={data} handleChange={handleChange} isReadOnly={!IS_AUTHOR} />
                        )}

                        {/* ì²­ì‚° í•­ëª© í™œì„±í™” */}
                        {data.status === "ì²­ì‚°" && (
                            <div style={{ border: '1px dashed #dc3545', padding: '15px', marginTop: '15px', borderRadius: '5px', backgroundColor: 'white' }}>
                                <h4>ì²­ì‚° ìƒì„¸ ì…ë ¥</h4>
                                
                                <label>ì²­ì‚°ê°€:</label>
                                <div className="input-unit-wrapper">
                                    <select 
                                        value={data.liquidationPriceType} 
                                        onChange={(e) => handlePriceTypeChange(e.target.value)}
                                        readOnly={!IS_AUTHOR}
                                    >
                                        <option value="ì¥ì¤‘ ê³ ê°€">ì¥ì¤‘ ê³ ê°€ ({stockData.TODAY_HIGH_PRICE.toLocaleString()}ì›)</option>
                                        <option value="ì§ì ‘ ìˆ˜ì¹˜ ì…ë ¥">ì§ì ‘ ìˆ˜ì¹˜ ì…ë ¥</option>
                                    </select>
                                </div>
                                
                                {data.liquidationPriceType === "ì§ì ‘ ìˆ˜ì¹˜ ì…ë ¥" && (
                                    <input type="number" value={data.liquidationValue} onChange={(e) => handleChange('liquidationValue', e.target.value)} placeholder="ì²­ì‚° ìˆ˜ì¹˜ ì…ë ¥" readOnly={!IS_AUTHOR} />
                                )}
                                
                                <label style={{ marginTop: '10px' }}>ì²­ì‚° ìˆ˜ëŸ‰: 
                                    <input 
                                        type="range" 
                                        min="0" 
                                        max="100" 
                                        value={data.liquidationQuantityPercent} 
                                        onChange={(e) => handleChange('liquidationQuantityPercent', e.target.value)} 
                                        readOnly={!IS_AUTHOR}
                                    />
                                    <span>{data.liquidationQuantityPercent}%</span>
                                </label>

                                {!IS_AUTHOR ? (
                                    <p style={{ color: '#dc3545', textAlign: 'center', marginTop: '10px', fontWeight: 'bold' }}>* ì²­ì‚° ê¸°ë¡ì€ ì£¼ì¸ë‹˜ë§Œ ì œì¶œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                                ) : (
                                    <button onClick={handleSubmitLiquidation} style={{ width: '100%', marginTop: '15px', backgroundColor: '#dc3545' }}>ì²­ì‚° ê¸°ë¡ ì œì¶œ</button>
                                )}
                            </div>
                        )}
                        
                        {/* ì „ë§ */}
                        <label style={{ marginTop: '20px' }}>ì „ë§ (ê¸€ë¡œ ì‘ì„±):
                            <textarea rows="4" value={data.outlook} onChange={(e) => handleChange('outlook', e.target.value)} placeholder={stockData.ë¶„ì„_ìë£Œ_B1} readOnly={!IS_AUTHOR}></textarea>
                        </label>
                    </div>
                </div>
            );
        };
        

        // ------------------- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ (Entry Gate êµ¬í˜„) -------------------
        const StockReportApp = () => {
            const [entryStatus, setEntryStatus] = useState({ symbol: '', date: '', search: '' });
            const [viewMode, setViewMode] = useState('entry'); 
            const [selectedStockData, setSelectedStockData] = useState(null);
            const [currentReportData, setCurrentReportData] = useState(null);
            const [isModalOpen, setIsModalOpen] = useState(false); 

            const isReadyToEnter = entryStatus.symbol && entryStatus.date;

            // ê²€ìƒ‰ ê²°ê³¼ë¥¼ í•„í„°ë§í•˜ëŠ” ë¡œì§
            const filteredStocks = entryStatus.search
                ? ALL_STOCKS.filter(stock => 
                    stock.name.toLowerCase().includes(entryStatus.search.toLowerCase()) || 
                    stock.code.includes(entryStatus.search)
                )
                : []; 

            const handleSelectStock = (stock) => {
                setEntryStatus(p => ({ 
                    ...p, 
                    search: `${stock.name} (${stock.code})`, 
                    symbol: stock.code 
                }));
            };

            const handleEntry = () => {
                if (entryStatus.symbol && entryStatus.date) {
                    const data = getStockData(entryStatus.symbol);
                    setSelectedStockData(data);
                    
                    const recordKey = `${entryStatus.symbol}_${entryStatus.date}`;
                    const dailyData = DAILY_RECORDS[recordKey] || INITIAL_USER_INPUT;
                    setCurrentReportData(dailyData);

                    setViewMode('report');
                } else {
                    alert('ì¢…ëª©ëª…ê³¼ ë‚ ì§œë¥¼ ëª¨ë‘ ì„ íƒí•´ì•¼ ì§„ì…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                }
            };
            
            const handleSelectRecord = (record) => {
                 const data = getStockData(record.symbol);
                 setSelectedStockData(data);
                 
                 const recordKey = `${record.symbol}_${record.date}`;
                 const dailyData = DAILY_RECORDS[recordKey] || INITIAL_USER_INPUT;
                 setCurrentReportData(dailyData);

                 setEntryStatus(p => ({ 
                    ...p, 
                    symbol: record.symbol, 
                    date: record.date, 
                    search: `${record.name} (${record.symbol})` 
                 }));

                 setViewMode('report');
            };

            const getCurrentDate = () => {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            };


            const renderContent = () => {
                const isReportOrRecords = viewMode === 'report';

                return (
                    <div className="app-container">
                        <h1 style={{ textAlign: 'center' }}>ë¶ˆì‚¬ì‚¬ê¸° ì£¼ì‹ ë¦¬ë”©ë¶</h1>
                        
                        {/* ë¦¬í¬íŠ¸ í™”ë©´ í—¤ë” */}
                        {isReportOrRecords && selectedStockData && (
                             <>
                                <p style={{ textAlign: 'center', color: '#8B4513', fontWeight: 'bold', fontSize: '1.1em', marginTop: '10px', lineHeight: '1.5em' }}>
                                    ì¢…ëª©: {selectedStockData.ì¢…ëª©ëª…} ({selectedStockData.symbol})
                                    <br/>
                                    ë‚ ì§œ: {entryStatus.date} {getDayOfWeek(entryStatus.date)}
                                </p>
                            </>
                        )}
                        
                        {/* ì¢…ëª© ì„ íƒ/ì§„ì… ë° ì¶”ì²œ ë¦¬ìŠ¤íŠ¸ í™”ë©´ */}
                        {viewMode === 'entry' && (
                            <>
                                <div className="entry-box">
                                    <label>ì¢…ëª© ê²€ìƒ‰ (ê¸€ì ì¼ë¶€ ì…ë ¥):
                                        <div className="input-wrapper">
                                            <input type="text" placeholder="ì¢…ëª©ëª… ë˜ëŠ” ì½”ë“œ ì…ë ¥ (ì˜ˆ: ì‚¼ì„±, 0059)" value={entryStatus.search} onChange={(e) => setEntryStatus(p => ({ ...p, search: e.target.value, symbol: '' }))}/>
                                            {filteredStocks.length > 0 && entryStatus.search && (
                                                <div className="search-results">
                                                    {filteredStocks.map(stock => (
                                                        <div key={stock.code} onClick={() => handleSelectStock(stock)} className="search-item">{stock.name} ({stock.code})</div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    </label>
                                    
                                    <button onClick={() => setIsModalOpen(true)} className="secondary" style={{ width: '100%', marginTop: '10px', backgroundColor: '#6c757d' }}>ğŸ“œ ì¢…ëª© ì§ì ‘ ì„ íƒí•˜ê¸°</button>
                                    
                                    {entryStatus.symbol && (<p style={{ marginTop: '15px', fontWeight: 'bold', color: '#8B4513' }}>ì„ íƒëœ ì¢…ëª©: {entryStatus.search}</p>)}

                                    {/* --- ë‚ ì§œ Input í•„ë“œ: ë ˆì´ë¸”ë§Œ í‘œì‹œ --- */}
                                    <label style={{ marginTop: '15px' }}>ë‚ ì§œ ë° ìš”ì¼ ì„ íƒ:</label> 
                                    <input 
                                        type="date" 
                                        value={entryStatus.date} 
                                        onChange={(e) => setEntryStatus(p => ({ ...p, date: e.target.value }))} 
                                        max={getCurrentDate()}
                                        style={{ width: '100%', paddingRight: '10px' }}
                                    />
                                    {entryStatus.date && <span style={{ marginLeft: '10px', fontWeight: 'bold', color: '#8B4513' }}>{getDayOfWeek(entryStatus.date)}</span>}
                                    
                                    <p style={{ fontSize: '0.9em', color: '#5a5a5a', marginTop: '5px' }}>ì¢…ëª©ê³¼ ë‚ ì§œë¥¼ ì„ íƒí•˜ì‹œë©´ í•´ë‹¹ ì¢…ëª©ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

                                    {/* --- ë°˜ì§ì„ ì ìš© --- */}
                                    <button 
                                        onClick={handleEntry} 
                                        disabled={!isReadyToEnter} 
                                        className={`main-entry ${isReadyToEnter ? 'pulse' : ''}`} 
                                        style={{ width: '100%', marginTop: '20px' }}
                                    >
                                        âœ¨ ë¦¬ë”©ë¶ ì§„ì…í•˜ê¸°
                                    </button>
                                </div>
                                
                                {/* ë§¤ë§¤ ì¶”ì²œ ì¢…ëª© ë¦¬ìŠ¤íŠ¸ (ë©”ì¸ í™”ë©´ í•˜ë‹¨ì— ë°”ë¡œ í‘œì‹œ) */}
                                <RecordsHome onSelectRecord={handleSelectRecord} />
                            </>
                        )}
                        
                        {/* ë¦¬í¬íŠ¸ í™”ë©´ */}
                        {viewMode === 'report' && selectedStockData && currentReportData && (
                            <ReportContent 
                                entryData={currentReportData} 
                                stockData={selectedStockData} 
                                onGoHome={() => setViewMode('entry')} /* ì´ì „ í™”ë©´ì€ entry view */
                            />
                        )}
                        
                        <StockModal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)} onSelectStock={handleSelectStock} />

                         <div className="developer-credit">
                            <p><strong>ğŸš¨ Disclaimer:</strong> íˆ¬ì ê²°ì • ë° ì‹¤í–‰ ê²°ê³¼ëŠ” íˆ¬ìì ë³¸ì¸ì´ ì±…ì„ì§‘ë‹ˆë‹¤.</p>
                            <p>ğŸ”¥ ì´ ë¶ˆì‚¬ì‚¬ê¸° ë¦¬ë”©ë¶ì€ **ì£¼ì¸ë‹˜**ê³¼ **ì œë¯¸ë‚˜ì´**ì˜ í•©ì‘í’ˆì…ë‹ˆë‹¤. ğŸ”¥</p>
                            <p className="version-info">Ver 1.0</p>
                        </div>
                    </div>
                );
            };


            return renderContent();
        };

        ReactDOM.render(<StockReportApp />, document.getElementById('root'));
    </script>
</body>
</html>